import{d as h,a as U,k as E,c as r,f as e,t as p,l as g,h as l,w as D,x as N,o as n,p as b,i as S,_ as C,y as M,g as d,m as B,u as O,r as I,F as V,b as L,z,e as T,n as A}from"./index-BpsLfx4t.js";import{_ as R}from"./basket-Dj2cRuHf.js";import{u as H,t as j,F as k,E as y,C as q}from"./schemas-DrmBcDwI.js";const G=t=>(b("data-v-54cf33bc"),t=t(),S(),t),J={class:"p-text-lg--bold title-post"},K={class:"p-text-sm date-avtor"},Q=["datetime"],W={class:"p-text-md brief-description"},X=G(()=>e("i",null,"Краткое описание:",-1)),Y={class:"p-text-md"},Z=h({__name:"FullCardPost",props:{post:{}},setup(t){const a=t,m=U();m.getUsersPosts(),m.getUserOnePost(a.post.id);const u=E(()=>m.userOnePost);return(o,c)=>{var i;const s=N("router-link");return n(),r("div",null,[e("h3",J,p(o.post.title),1),e("div",K,[e("time",{datetime:o.post.dateTime},p(new Date(o.post.dateTime).toLocaleString()),9,Q),e("span",null,[g(" Автор: "),l(s,{to:{name:"user",params:{id:(i=u.value)==null?void 0:i.id}},class:"link link-avtor"},{default:D(()=>{var _;return[g(p((_=u.value)==null?void 0:_.fullName),1)]}),_:1},8,["to"])])]),e("p",W,[X,g(" "+p(o.post.briefDescription),1)]),e("p",Y,p(o.post.fullDescription),1)])}}}),ee=C(Z,[["__scopeId","data-v-54cf33bc"]]),te=t=>(b("data-v-2549a0c3"),t=t(),S(),t),se={class:"comment-sender"},oe=te(()=>e("div",{class:"avatar"},null,-1)),ae={class:"date-avtor"},ne={class:"name-sender"},ce=["datetime"],me=h({__name:"CommentSender",props:{name:{},date:{}},setup(t){return(a,m)=>(n(),r("div",se,[oe,e("div",ae,[e("span",ne,p(a.name),1),e("time",{datetime:a.date},p(new Date(a.date).toLocaleString()),9,ce)])]))}}),ie=C(me,[["__scopeId","data-v-2549a0c3"]]),re={class:"comment"},de=h({__name:"UserComment",props:{comment:{}},emits:["update"],setup(t,{emit:a}){const m=t,u=a,o=M();function c(){o.deleteComment(m.comment.id),u("update")}return(s,i)=>(n(),r("div",null,[l(ie,{name:s.comment.userInfo,date:s.comment.dateTime,class:"comment-sender"},null,8,["name","date"]),e("div",re,[e("span",null,p(s.comment.textComment),1),e("img",{src:R,alt:"",class:"btn-delete",title:"удалить",onClick:c})])]))}}),le=C(de,[["__scopeId","data-v-6ab41df3"]]),w=t=>(b("data-v-b5b691cd"),t=t(),S(),t),pe={class:"group-input"},ue={class:"wrapper-input"},_e=w(()=>e("label",{for:"userInfo"},"Имя",-1)),ve={class:"wrapper-input"},fe=w(()=>e("label",{for:"email"},"Email",-1)),he={class:"wrapper-input"},Ce=w(()=>e("button",{type:"submit",class:"btn"},"Отправить",-1)),be=h({__name:"CommentForm",props:{idPost:{}},emits:["submit","cancel"],setup(t,{emit:a}){const m=t,u=a,o=j(q),{handleSubmit:c}=H({validationSchema:o,initialValues:{id:new Date().getTime()+Math.floor(Math.random()*1e3),idPost:m.idPost,dateTime:new Date().toISOString()}}),s=c(i=>{u("submit",i)});return(i,_)=>(n(),r("form",{class:"form",onSubmit:_[0]||(_[0]=(...v)=>d(s)&&d(s)(...v))},[e("div",pe,[e("div",ue,[_e,l(d(k),{type:"text",name:"userInfo",id:"userInfo",class:"input"}),l(d(y),{name:"userInfo",class:"p-error-2"})]),e("div",ve,[fe,l(d(k),{type:"email",name:"email",id:"email",class:"input"}),l(d(y),{name:"email",class:"p-error-2"})])]),e("div",he,[l(d(k),{name:"textComment"},{default:D(({field:v})=>[e("textarea",B(v,{class:"input",placeholder:"Написать комментарий"}),null,16)]),_:1}),l(d(y),{name:"textComment",class:"p-error-2"})]),Ce],32))}}),Se=C(be,[["__scopeId","data-v-b5b691cd"]]),$e=t=>(b("data-v-80a3301f"),t=t(),S(),t),ge={key:0},Ie={class:"comments",id:"comments"},ke=$e(()=>e("h3",{class:"p-text-md--bold"},"Комментарии",-1)),ye={key:0,class:"list-comments"},we={key:1,class:"empty-comment"},Pe={key:1},xe=h({__name:"post",setup(t){const a=O(),m=M(),o=A().params.id,c=I(a.getPostId(+o)),s=I(E(()=>{var f;return((f=c.value)==null?void 0:f.comments)??[]}));s.value=s.value.reverse();const i=I(!1);function _(f){m.createComment(f),v(),i.value=!1}function v(){c.value=a.getPostId(+o),s.value=s.value.reverse()}return(f,P)=>{var x,F;return c.value?(n(),r("div",ge,[l(ee,{post:c.value,class:"full-carg-post"},null,8,["post"]),e("div",Ie,[ke,((x=c.value.comments)==null?void 0:x.length)!==0?(n(),r("div",ye,[(n(!0),r(V,null,L(s.value,$=>(n(),T(le,{key:$.id,comment:$,onUpdate:v},null,8,["comment"]))),128))])):(n(),r("div",we,"Нет комментариев"))]),i.value?(n(),T(Se,{key:1,id:"form","id-post":+d(o),onSubmit:_,class:"comment-form"},null,8,["id-post"])):(n(),r("button",{key:0,class:z(["btn-write-comment",{"btn-empty-comment":((F=c.value.comments)==null?void 0:F.length)===0}]),onClick:P[0]||(P[0]=$=>i.value=!0)}," Написать комментарий ",2))])):(n(),r("div",Pe,"404"))}}}),De=C(xe,[["__scopeId","data-v-80a3301f"]]);export{De as default};
